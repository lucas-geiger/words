---
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 5);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Words - A Blog</title>
  </head>
  <body>
    <header>
      <h1>Words</h1>
      <nav>
        <a href={`${import.meta.env.BASE_URL}`}>Home</a>
        <a href={`${import.meta.env.BASE_URL}blog`}>Blog</a>
      </nav>
    </header>

    <main>
      <h2>Recent Posts</h2>
      {
        posts.length === 0 ? (
          <p>No posts yet. Check back soon!</p>
        ) : (
          <ul>
            {posts.map((post) => (
              <li>
                <a href={`${import.meta.env.BASE_URL}blog/${post.id}`}>{post.data.title}</a>
                <time>{post.data.pubDate.toLocaleDateString()}</time>
                <p>{post.data.description}</p>
              </li>
            ))}
          </ul>
        )
      }
    </main>
  </body>
</html>
